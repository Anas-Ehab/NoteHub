# 01 Information Gathering

## WSTG-INFO-01 - Conduct Search Engine Discovery Reconnaissance for Information Leakage
* Search on different search engines and use search operators:
  - *site:pastebin.com TARGET* - Related pastebins to the target
  - *site:pastebin.com intitle: PERSONNAME* - Specific person on pastebin.com
  - *intitle:"Index of"* - Search for directory index
  - *intitle:index.of.etc* - Search for etc directory
  - *intitle:"Index of" config.php* - SQL Credentials & Config files
  - *intitle:"Index of" wp-config.php* - SQL Credentials & Config files

* Search for cached versions (*cache: TARGET*)


## WSTG-INFO-02 - Fingerprint Web Server
* Use nmap to determine the version and type of a running web server to enable further discovery of any known vulnerabilities.
* nmap:
  - *nmap IPADDRESS* - Scans the top 1000 ports and determine if they are open or not
  - *nmap IPADDRESS -O* - Tries to enumrate the operating system of the server
  - *nmap IPADDRESS -p-* - Scans all 65535 TCP ports
  - *nmap IPADDRESS -sC* - Scans and runs the set of default scripts
  - *nmap IPADDRESS -A* - Scans with all the previously mentioned
  - *nmap IPADDRESS -sU -p-* - Scans all UDP ports

Extra Tools/Alternatives:
* Zenmap: The GUI version of nmap.
* [Netcraft](https://toolbar.netcraft.com/site_report), an online tool that scans sites for information, including web server details.
* [Nikto](https://github.com/sullo/nikto), an Open Source command-line scanning tool.
* [Wappalyzer](https://www.wappalyzer.com/), Available as an extension for your web browser and can extract information about the web technologies used.


## WSTG-INFO-03 - Review Webserver Metafiles for Information Leakage
* Robots.txt File:
  - *URL/robots.txt*
  - *wget URL/robots.txt*
  - *curl URL/robots.txt*

* Sitemap File:
  - *URL/sitemap.xml*
  - *wget --no-verbose URL/sitemap.xml*
  - *curl URL/sitemap.xml*

* Security File:
  - *URL/security.txt*
  - *URL/.wellknown/security.txt*
  - *wget --no-verbose URL/.well-known/security.txt*

* Humans.txt File:
  - *URL/humans.txt*
  - *wget --no-verbose  URL/humans.txt*

## WSTG-INFO-04 - Enumerate Applications on Webserver
* Different Base URL
  - *ffuf - u https://URL/FUZZ -w WORDLIST -p 1 -fc 401* (-p is seconds of delay -fc is excluded responses)
  - *ffuf - u https://FUZZ.URL -w WORDLIST -p 1 -fc 401* (-p is seconds of delay -fc is excluded responses)

* None Standard Ports
  - *nmap –Pn –sT –sV –p0-65535 IPADDRESS*
  - When you find an active nonstandard port try checking it
    1. *URL:PORTNUMBER*
    2. *telnet IPADDRESS PORTNUMBER*

* Virtual Hosts (****To Be Completed****)

## WSTG-INFO-05 - Review Web Page Content for Information Leakage
* Review Web Page Comments and Metadata.
  - Look for HTML comments which start with *<!--*.
  - Check HTML version information for valid version numbers and Data Type Definition (DTD) URLs (strict.dtd -- default strict DTD / loose.dtd -- loose DTD / frameset.dtd -- DTD for frameset documents).
  - Search for *meta* tags as a common use for META tag is to specify keywords that a search engine may use to improve the quality of search results and it can also be used to manage search engine indexing.
  - Search for JavaScript files (*.js*).

* Identifying JavaScript Code and Gathering JavaScript Files
  - Search for hardcode sensitive information in JavaScript variables.
  - If you find an API key check if this API Key is restricted by IP or not because if it's not restricted by an IP address, attackers can still use that API Key to query unrestricted APIs and the application owner must pay for that.

* Identifying Source Map Files
  - Add the ".map" extension after the extension of each external JavaScript file.
  - If accessible, check source map files for any sensitive information.

* Identify Redirect Responses which Leak Information
  - Check redirects using Burp, ZAP, or any other personal proxy software.
