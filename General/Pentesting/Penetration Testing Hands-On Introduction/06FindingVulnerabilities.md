# Finding Vulnerabilities

## Nessus 
* Tenable Security’s Nessus is one of the most widely used commercial vulnerability scanners.
* Nessus database includes vulnerabilities across platforms and protocols, and its scanner performs a series of checks to detect known issues.
* Nessus is available as a paid professional version.
* Nessus Home (The Free Version) is limited to scanning 16 IP addresses.
* To start (*systemctl start nessusd*)
* Then browse to *https://IPADDRESS:8834*
* To stop (*systemctl stop nessusd*)
* Nessus policies are like configuration files that tell Nessus which vulnerability checks, port scanners, and so on to run in the vulnerability scan.
* If you have credentials, Nessus can authenticate with hosts and look for vulnerabilities that may not be apparent from a network-facing perspective.
* To do a scan, Nessus needs to know the name for our scan (Name), which scan policy to use (Policy), and which systems to scan (Targets).
* The Nessus output for a particular issue will often give you some information about that issue’s potential exploitability.
* Nessus ranks vulnerabilities based on the Common Vulnerability Scoring System (CVSS), version 2, from the National Institute of Standards and Technology (NIST).
* Once a Nessus scan finishes, you can export its findings. Nessus can output results into PDF, HTML, XML, CSV, and other formats.
* If the Nessus summary page doesn’t give you enough information about a vulnerability, try a good old-fashioned Google search. Additionally, try searching *http://www.securityfocus.com/*, *http://www.packetstormsecurity.org/*, *http://www.exploit-db.org/*, and *http://www.cve.mitre.org/*.
* Depending on your subject vulnerability, you may be able to find proof-of-concept exploit code online as well.


## The Nmap Scripting Engine
* The Nmap Scripting Engine (NSE) lets you run publicly available scripts and write your own.
* You’ll find the scripts packaged with the NSE in Kali at */usr/share/nmap​/scripts*.
* The available scripts fall into several categories, including information gathering, active vulnerability assessment, searches for signs of previous compromises, and so on.
* To get more information about a particular script or category of scripts, enter the *--script-help* flag in Nmap (i.e. to see all scripts in the default category enter *nmap --script-help default*).
* If you use the *-sC* flag to tell Nmap to run a script scan in addition to port scanning, it will run all the scripts in the default category.
* Some NSE scripts may crash services or harm the target system, and an entire category is dedicated to denial of service. For example, the script *smb-check-vulns* will check for the MS08-067 vulnerability and other SMB vulnerabilities. Its help information notes that this script is likely dangerous and shouldn’t be run on production systems unless you are prepared for the server to go down.

## Metasploit Scanner Modules
* Metasploit also can conduct vulnerability scanning via numerous auxiliary modules.
* Unlike exploits, these modules will not give us control of the target machine, but they will help us identify vulnerabilities for later exploitation.
* One such Metasploit module looks for FTP services that provide anonymous access. Although it may be easy enough to attempt to log in manually to individual FTP servers, Metasploit auxiliary modules let us scan many hosts at once, which will save time when you’re testing a large environment.

## Metasploit Exploit Check Functions
* Some Metasploit exploits include a check function that connects to a target to see if it is vulnerable, rather than attempting to exploit a vulnerability.
* There’s no need to specify a payload when running check because no exploitation will take place.
* Unfortunately, not all Metasploit modules have check functions. (If you try running check on a module that doesn’t support it, Metasploit will tell you.)

## Web Application Scanning
* Although a client’s custom-built apps may have security problems, your target may also deploy prebuilt web applications such as payroll apps, webmail, and so on, which can be vulnerable to the same issues.
* If we can find an instance of known vulnerable software, we may be able to exploit it to get a foothold in a remote system.

### Nikto
* Nikto is a web application vulnerability scanner built into Kali that’s like Nessus for web apps: It looks for issues such as dangerous files, outdated versions, and misconfigurations.
* Usage: *nikto -h IPADDRESS*
* OSVDB (http://osvdb.com/) is a vulnerability repository specifically for open-source software such as TikiWiki, with detailed information on a wide variety of products. Use it to search for additional information about possible issues you find.

### Attacking XAMPP
* By default, XAMPP installations include phpMyAdmin, a database administration web application.
* Ideally, phpMyAdmin would not be available over the network, or at least it should require credentials to access it.

### Default Credentials
* Most software comes with a default credentials, check for these credentials as most of the time the IT admin doesn't change these passwords


## Manual Analysis
* Sometimes, no solution will work nearly as well as manual vulnerability analysis to see if a service will lead to a compromise, and there’s no better way to improve than practice.

### Exploring a Strange Port
* Sometimes when you scan with an Nmap version scan you’ll notice that a specific port crashes.
* This behavior suggests that the listening program is designed to listen for a particular input and that it has difficulty processing anything else.
* This sort of behavior is interesting to pentesters, because programs that crash when handling malformed input aren’t validating input properly.
* Try connecting to the port with a browser (*IPADDRESS:PORT#*)
* Or you can use netcat (nc IPADDRESS PORT)

### Finding Valid Usernames
* We can drastically increase our chances of a successful password attack if we know valid usernames for services.
* One way to find valid usernames for mail servers is to use the VRFY SMTP command, if it is available.

  
