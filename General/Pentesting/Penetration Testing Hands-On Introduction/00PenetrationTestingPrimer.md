# Penetration Testing Primer
*  Penetration Testing involves simulating real attacks to assess the risk associated with potential security breaches.
*  On a pentest (as opposed to a vulnerability assessment), the testers not only discover vulnerabilities that could be used by attackers but also exploit vulnerabilities, where possible, to assess what attackers might gain after a successful exploitation.

## Stages

### Pre-engagement
* Involves talking to the client about their goals for the pentest, mapping out the scope (the extent and parameters of the test), and so on.
* The pre-engagement stage is when you should take the time to understand your client’s business goals for the pentest.

* Ask questions like:
  - what prompted them to find a pentester?
  - What exposures are they most worried about?
  - Do they have any fragile devices you need to be careful with when testing?
  - What matters most to them?

* Make sure to agree on:
  - Scope:
    1. What IP addresses or hosts are in scope, and what is not in scope?
    2. What sorts of actions will the client allow you to perform?
    3. Are you allowed to use exploits and potentially bring down a service, or should you limit the assessment to merely detecting possible vulnerabilities?
    4. Does the client understand that even a simple port scan could bring down a server or router?
    5. Are you allowed to perform a social engineering attack?

  - The testing window:
    1. The client may want you to perform tests only during specific hours or on certain days.

  - Contact information:
    1. Whom should you contact if you find something serious?
    2. Does the client expect you to contact someone 24 hours a day?
    3. Do they prefer that you use encryption for email?

  - A "get out of jail free" card
    1. Make sure you have authorization to perform a penetration test on the target.
    2. If a target is not owned by the company (for instance, because it’s hosted by a third party), make sure to verify that the client has  formal approval from the third party to perform the penetration test.
    3. Make sure your contract includes a statement that limits your liability in case something unexpected happens and get written permission to perform the test.

  - Payment Terms:
    1. How and when will you be paid, and how much?
    2. Finally, include a nondisclosure agreement clause in your contract.
    3. Clients will appreciate your written commitment to keep the penetration test and any findings confidential.


### Information Gathering Phase
* During this phase, you analyze freely available sources of information, a process known as gathering open-source intelligence (OSINT).
* You also begin to use tools such as port scanners to get an idea of what systems are out there on the Internet or internal network as well as what software is running.


### Threat Modeling
*  Here we think like attackers and develop plans of attack based on the information we’ve gathered.
*  Based on the data we found during information gathering, we develop strategies to penetrate a client’s systems.


### Vulnerability Analysis
* Pentesters begin to actively discover vulnerabilities to determine how successful their exploit strategies might be.
* Failed exploits can crash services, set off intrusion-detection alerts, and otherwise ruin your chances of successful exploitation.
* Often during this phase, pentesters run vulnerability scanners, which use vulnerability databases and a series of active checks to make a best guess about which vulnerabilities are present on a client’s system
* But though vulnerability scanners are powerful tools, they can’t fully replace critical thinking, so we also perform manual analysis and verify results on our own in this phase as well.


### Exploitation
*  Here we run exploits against the vulnerabilities we’ve discovered in an attempt to access a client’s systems.


### Post Exploitation
* During post exploitation, we gather information about the attacked system, look for interesting files, attempt to elevate our privileges where necessary, and so on.
* We might also try to use the exploited machine to attack systems not previously available to us by pivoting into them.


### Reporting
* The final phase of penetration testing is reporting.
* This is where we convey our findings to the customer in a meaningful way.
* The pentest report should include both an executive summary and a technical report
* Executive Summary:
  - The executive summary describes the goals of the test and offers a high-level overview of the findings. The intended audience is the executives in charge of the security program. Your executive summary should include the following:
    1. Background: A description of the purpose of the test and definitions of any terms that may be unfamiliar to executives, such as vulnerability and countermeasure.
    2. Overall posture: An overview of the effectiveness of the test, the issues found (such as exploiting the MS08-067 Microsoft vulnerability), and general issues that cause vulnerabilities, such as a lack of patch management.
    3. Risk profile: An overall rank of the organization’s security posture compared to similar organizations with measures such as high, moderate, or low. You should also include an explanation of the ranking.
    4. General findings: A general synopsis of the issues identified along with statistics and metrics on the effectiveness of any countermeasures deployed.
    5. Recommendation summary: A high-level overview of the tasks required to remediate the issues discovered in the pentest.
    6. Strategic road map: Give the client short- and long-term goals to improve their security posture. For example, you might tell them to apply certain patches now to address short-term concerns, but without a long-term plan for patch management, the client will be in the same position after new patches have been released.

* Technical Report:
  - This section of the report offers technical details of the test. It should include the following:
    1. Introduction: An inventory of details such as scope, contacts, and so on.
    2. Information gathering: Details of the findings in the information gathering phase. Of particular interest is the client’s Internet footprint.
    3. Vulnerability assessment: Details of the findings of the vulnerability analysis phase of the test.
    4. Exploitation/vulnerability verification: Details of the findings from the exploitation phase of the test.
    5. Post exploitation: Details of the findings of the post-exploitation phase of the test.
    6. Risk/exposure: A quantitative description of the risk discovered. This section estimates the loss if the identified vulnerabilities were exploited by an attacker.
    7. Conclusion: A final overview of the test. 
    

