# Information Gathering
* The goal of this phase is to learn as much about our clients as we can.

## Open Source Intelligence Gathering (OSINT)
* As opposed to intelligence gained from covert sources such as dumpster diving, dumping website databases, and social engineering, open source intelligence (or OSINT) is gathered from legal sources like public records and social media.
* Sometimes the information that web servers and web-hosting companies gather and make publicly available can tell you a lot about a website.
* Tools:
  - Netcraft (*http://www.netcraft.com/*):
    1. Netcraft logs the uptime and makes queries about the underlying software.
  
  - Whois Lookups (*whois URL*)
    1. All domain registrars keep records of the domains they host.
    2. These records contain information about the owner, including contact information.

  - DNS Reconnaissance
    1.  Domain Name System (DNS) servers can be used to learn more about a domain.

    2. Nslookup (*nslookup URL*)
       - Returns the IP address of a domain.
       - Can be used to find the mail servers (*set type=mx*)

    3. Host (*host -t ns URL*)
       - Can be used to get the name servers

    4. Zone Transfers
       - DNS zone transfers allow name servers to replicate all the entries about a domain.
       - When setting up DNS servers, you typically have a primary name server and a backup server.

  - Searching for Email Addresses
    1. theHarvester (*theharvester -d URL -l 500 -b all*)
       - Finds emails and other websites

    2. Maltego (*maltego*)
       - Maltego has both a commercial and a free community edition
       - Maltego uses information publicly available on the Internet, so it is perfectly legal to do reconnaissance on any entity.
       - In skilled hands, Maltego can turn hours of reconnaissance work into minutes with the same quality results.

  - Port Scanning
    1. Manual Scanning
       - We can do this manually by connecting to ports with a tool such as telnet or Netcat and recording the results.
       - Command: *nc -vv IPADDRESS PORTNUMBER*
       - Now, keep in mind that admins can change banners like this to say anything, even sending attackers and pentesters on a wild goose chase, studying vulnerabilities for a product that is not deployed.
       - On the other hand, connecting to every possible TCP and UDP port on just one machine and noting the results can be time consuming.

    2. Automatic Scanning
       - Nmap is an industry standard for port scanning.
       - Firewalls with intrusion-detection and prevention systems have made great strides in detecting and blocking scan traffic, so you might run an Nmap scan and receive no results at all.
       - Though you could be hired to perform an external pentest against a network range with no live hosts, it’s more likely that you’re being blocked by a firewall.

       - A SYN Scan
         * A SYN scan is a TCP scan that does not finish the TCP handshake.
         * In a SYN scan, Nmap sends the SYN and waits for the SYN-ACK if the port is open but never sends the ACK to complete the connection.
         * If the SYN packet receives no SYN-ACK response, the port is not available; either it’s closed or the connection is being filtered.
         * Command: *nmap -sS IPADDRESS -oA FILENAME* (sS is for SYN scan oA is to export in all formats)
         * Just because a port is open does not mean that vulnerabilities are present. Rather it leaves us with the possibility that vulnerable software might be running on these ports.

       - A Version Scan
         * Nmap completes the connection and then attempts to determine what software is running and, if possible, the version, using techniques such as banner grabbing.
         * Not stealthy
         * *-sV* instead of *-sS*

       - Keep in mind that Nmap may report the wrong version in some cases (for instance, if the software has been updated, but the welcome banner is not edited as part of the patch)

       - UDP Scans
         * Both Nmap’s SYN and version scans are TCP scans that do not query UDP ports.
         * Because UDP is connectionless, the scanning logic is a bit different.
         * In a UDP scan (*-sU*), Nmap sends a UDP packet to a port. Depending on the port, the packet sent is protocol specific. If it receives a response, the port is considered open. If the port is closed, Nmap will receive an ICMP Port Unreachable message.
         * If Nmap receives no response whatsoever, then either the port is open and the program listening does not respond to Nmap’s query, or the traffic is being filtered.
         * Thus, Nmap is not always able to distinguish between an open UDP port and one that is filtered by a firewall

        - Scanning a Specific Port
          * By default, Nmap scans only the 1,000 ports it considers the most “interesting,” not the 65,535 possible TCP or UDP ports.
          * To scan specific ports, use the *-p* flag with Nmap.
         
        - A good rule of thumb is to specify ports 1 through 65535 (*–p–*) on your pentests, just to make sure there’s nothing listening on those other “uninteresting” ports.
